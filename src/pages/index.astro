---
import Layout from '../layouts/Layout.astro';
import ToolCard from '../components/ToolCard.astro';
import { tools } from '../data/tools';

const sortedTools = [...tools].sort(
    (a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()
);
---

<Layout
    title="Keeler Tools"
    description="Browser-native utilities built for small daily curiosities."
>
    <main class="relative overflow-hidden">
        <div class="absolute inset-0">
            <div class="absolute -left-20 top-16 h-80 w-80 rounded-full bg-brand/20 blur-[120px]">
            </div>
            <div
                class="absolute right-10 top-0 h-64 w-64 rounded-full bg-brand-dark/20 blur-[110px]"
            >
            </div>
            <div
                class="absolute bottom-[-10%] left-[40%] h-72 w-72 rounded-full bg-sky-200/40 blur-[120px]"
            >
            </div>
        </div>

        <section
            class="relative mx-auto flex min-h-[70vh] max-w-6xl flex-col justify-center gap-10 px-6 py-24"
        >
            <div class="max-w-2xl">
                <p class="text-sm font-semibold uppercase tracking-[0.3em] text-brand-dark">
                    Tools.keeler.dev
                </p>
                <h1
                    class="mt-4 font-display text-4xl font-semibold leading-tight text-slate-900 sm:text-6xl"
                >
                    Tiny tools with a clear purpose and a little bit of wonder.
                </h1>
                <p class="mt-4 text-lg text-slate-700">
                    Browser-only tools built with AI for fun and learning.
                </p>
                <div class="mt-4">
                    <a
                        class="inline-flex items-center gap-2 text-sm font-semibold text-brand-dark underline underline-offset-4 transition hover:text-brand"
                        href="/learnings"
                    >
                        Read about what I've learned building this
                        <span aria-hidden="true">â†’</span>
                    </a>
                </div>
            </div>

            <!-- Search Input -->
            <div class="mb-6">
                <label for="tool-search" class="sr-only">Search tools</label>
                <input
                    type="text"
                    id="tool-search"
                    placeholder="Search tools..."
                    class="w-full rounded-full border border-slate-200 bg-white px-6 py-3 text-slate-900 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20"
                />
            </div>

            <!-- Tool Grid -->
            <div id="tool-grid" class="grid gap-6 sm:grid-cols-2">
                {sortedTools.map((tool) => <ToolCard tool={tool} />)}
            </div>

            <!-- Empty State -->
            <div
                id="empty-state"
                class="hidden rounded-3xl border border-slate-200 bg-white p-12 text-center shadow-sm"
            >
                <p class="text-lg text-slate-600">No tools match that criteria</p>
            </div>
        </section>

        <section class="relative mx-auto max-w-6xl px-6 pb-24">
            <div class="grid gap-6 sm:grid-cols-2">
                <div
                    class="rounded-2xl border border-slate-200 bg-white p-6 shadow-[0_40px_90px_-70px_rgba(15,23,42,0.4)]"
                >
                    <h3 class="font-display text-xl font-semibold text-slate-900">
                        New drops every two weeks
                    </h3>
                    <p class="mt-2 text-sm text-slate-600">
                        Each tool is intentionally small, focused, and ready to use in the browser.
                    </p>
                </div>
                <div
                    class="rounded-2xl border border-slate-200 bg-white p-6 shadow-[0_40px_90px_-70px_rgba(15,23,42,0.4)]"
                >
                    <h3 class="font-display text-xl font-semibold text-slate-900">
                        No heavy frameworks
                    </h3>
                    <p class="mt-2 text-sm text-slate-600">
                        Just Astro, Tailwind, and small JavaScript libraries when they add delight.
                    </p>
                </div>
            </div>
        </section>
    </main>
</Layout>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('tool-search') as HTMLInputElement;
        const toolGrid = document.getElementById('tool-grid') as HTMLElement;
        const emptyState = document.getElementById('empty-state') as HTMLElement;
        const toolCards = document.querySelectorAll('.tool-card') as NodeListOf<HTMLElement>;

        if (!searchInput || !toolGrid || !emptyState) return;

        searchInput.addEventListener('input', (e) => {
            const searchTerm = (e.target as HTMLInputElement).value.toLowerCase().trim();
            let visibleCount = 0;

            toolCards.forEach((card) => {
                const title = card.dataset.toolTitle || '';
                const description = card.dataset.toolDescription || '';

                const titleMatch = title.includes(searchTerm);
                const descriptionMatch = description.includes(searchTerm);
                const isMatch = titleMatch || descriptionMatch;

                if (isMatch || searchTerm === '') {
                    card.style.display = '';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });

            if (visibleCount === 0) {
                toolGrid.classList.add('hidden');
                emptyState.classList.remove('hidden');
            } else {
                toolGrid.classList.remove('hidden');
                emptyState.classList.add('hidden');
            }
        });
    });
</script>
